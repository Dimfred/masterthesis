import numpy as np
import pandas as pd

from tabulate import tabulate

def ffloat(f):
    return f"{f:.4f}"

def ffloats(fs):
    return [ffloat(f) for f in fs]

def fsci(f, *p):
    if f == 0.01:
        return "1.0e-2"
    if f == 0.005:
        return "5.0e-3"
    if f == 0.0025:
        return "2.5e-3"
    if f == 0.001:
        return "1.0e-3"
    if f == 0.0005:
        return "5.0e-4"
    if f == 0.00025:
        return "2.5e-4"
    if f == 0.0001:
        return "1.0e-4"

    return None

########################################################################################
## LR
########################################################################################

res = {
    0.01: (83.29903, 82.89061, 83.01646),
    0.005: (82.49348, 82.85790, 81.51328),
    0.0025: (82.72171, 81.99200, 81.93025),
    0.001: (83.12994, 82.57712, 83.19931),
    0.0005: (82.69577, 82.94604, 82.57509),
    0.00025: (82.55172, 82.35741, 82.19239),
    0.0001: (81.68054, 81.44921, 81.67149),
}
res = sorted(res.items(), reverse=True)

pretty = [["LR", "Mean", "Std"]]
for lr, runs in res:
    runs = np.array(runs)
    pretty += [[lr, runs.mean(), runs.std()]]
print(tabulate(pretty))

########################################################################################
## OFFLINE AUG
########################################################################################

res = (
    ((0, 0, 0), (83.29903, 82.89061, 83.01646)),
    ((0, 0, 1), (83.45442, 83.63076, 83.82413)),
    ((0, 1, 0), (83.89591, 84.56100, 83.51876)),
    ((0, 1, 1), (83.46847, 84.46586, 83.15600)),
    ((1, 0, 0), (85.23983, 84.51490, 84.26195)),
    ((1, 0, 1), (85.09336, 84.42223, 84.59901)),
    ((1, 1, 0), (84.11455, 84.38198, 84.43308)),
    ((1, 1, 1), (85.50255, 84.88704, 84.33488)),
)

pretty = [["PFR", "Mean", "Std"]]
for (p, f, r), runs in res:
    runs = np.array(runs)
    pretty += [[f"P{p}F{f}R{r}", runs.mean(), runs.std()]]
print(tabulate(pretty))


########################################################################################
## ROTATION
########################################################################################
res = (
    (0, (85.50255, 84.88704, 84.33488)),
    (10, (84.23689, 85.06489, 84.85812)),
    (20, (84.96628, 85.36835, 84.53506)),
    (30, (83.77186, 84.65420, 83.69778)),
)

pretty = [["Rotation", "Mean", "Std"]]
for rot, runs in res:
    runs = np.array(runs)
    pretty += [[rot, runs.mean(), runs.std()]]
print(tabulate(pretty))

########################################################################################
## SCALE
########################################################################################
res = (
    (0, (85.50255, 84.88704, 84.33488)),
    (0.1, (83.55176, 83.19931, 83.40881)),
    (0.2, (83.20576, 83.07797, 83.35737)),
    (0.3, (83.08891, 82.81269, 84.58560)),
)

pretty = [["Scale", "Mean", "Std"]]
for scale, runs in res:
    runs = np.array(runs)
    pretty += [[scale, runs.mean(), runs.std()]]
print(tabulate(pretty))

########################################################################################
## CROP
########################################################################################
res = (
    (0, (85.50255, 84.88704, 84.33488)),
    (0.7, (84.47065, 84.75834, 84.81954)),
    (0.8, (85.18958, 84.89105, 84.99763)),
    (0.9, (85.73553, 85.57474, 85.80949)),
)

pretty = [["Crop", "Mean", "Std"]]
for crop, runs in res:
    runs = np.array(runs)
    pretty += [[crop, runs.mean(), runs.std()]]
print(tabulate(pretty))

########################################################################################
## COLOR
########################################################################################
res = (
    (0, (85.50255, 84.88704, 84.33488)),
    (0.1, (85.39170, 85.19188, 86.07763)),
    (0.2, (85.37144, 85.89094, 85.76421)),
    (0.3, (85.31983, 84.56982, 85.53279)),
)

pretty = [["Color", "Mean", "Std"]]
for color, runs in res:
    runs = np.array(runs)
    pretty += [[color, runs.mean(), runs.std()]]
print(tabulate(pretty))

########################################################################################
## GRID
########################################################################################
# fmt: off
# VALID AND TEST
# res = (
#     ((32, "focal2_0.1", 0.01),     ((71.55604,82.33384,85.46780,83.87156),(72.71673,84.71085,84.97444,84.84244),(72.47339,83.15338,85.59710,84.35754)),((63.63099,63.68742,90.82243,74.87220), (64.94267,68.43416,89.47128,77.55137), (61.38681,59.31181,92.07741,72.14883))),
#     ((32, "focal2_0.1", 0.005),    ((71.42833,82.95057,84.31638,83.62790),(72.53091,80.89479,88.22441,84.40077),(72.60088,84.13444,85.19870,84.66322)),((62.73436,64.14271,86.90714,73.80953), (62.91272,60.67675,92.53566,73.29384), (64.87150,65.75367,90.01013,75.99322))),
#     ((32, "focal2_0.1", 0.0025),   ((69.76995,87.07775,79.24222,82.97541),(70.39583,86.74032,79.83755,83.14592),(71.30177,86.25926,81.43468,83.77757)),((64.80292,69.89942,85.24964,76.81516), (65.76136,69.89646,85.40619,76.87686), (66.37072,71.49075,87.60772,78.73290))),
#     ((32, "focal2_0.1", 0.001),    ((72.18665,86.44200,81.94312,84.13246),(71.04535,86.06257,81.41576,83.67470),(70.89234,85.50903,81.12072,83.25709)),((68.29430,75.14870,87.69403,80.93812), (67.45955,75.17906,85.58606,80.04572), (66.60022,74.56474,84.69653,79.30836))),
#     ((32, "focal2_0.1", 0.0005),   ((72.49366,84.02083,84.34792,84.18406),(71.72665,81.76910,86.17807,83.91571),(72.46090,83.86638,84.87317,84.36677)),((67.18244,73.25584,88.25595,80.05934), (63.73181,67.50624,90.25818,77.24163), (66.32534,71.47733,89.33625,79.41514))),
#     ((32, "focal2_0.1", 0.00025),  ((71.89427,82.16170,85.52317,83.80874),(72.50727,84.12680,84.64296,84.38409),(72.21851,83.07257,84.98530,84.01805)),((67.43229,73.15572,89.60917,80.55083), (67.57618,73.81055,88.72145,80.58203), (67.28034,73.22992,89.11775,80.39642))),
#     ((32, "focal2_0.1", 0.0001),   ((70.74006,80.42174,85.79508,83.02155),(70.72703,79.84110,86.26952,82.93092),(71.60926,80.34503,86.75378,83.42650)),((66.07722,71.49696,89.73436,79.58421), (66.06591,70.63129,90.70061,79.41766), (65.77256,70.25533,90.92325,79.26416))),
#     ((32, "focal2_0.8", 0.01),     ((72.39006,82.77719,85.68961,84.20822),(72.63937,83.48208,85.77546,84.61323),(73.17325,84.86112,84.58339,84.72203)),((65.01603,66.35510,90.56428,76.59222), (64.44852,65.99791,88.69735,75.68221), (64.64719,64.73676,89.93575,75.28357))),
#     ((32, "focal2_0.8", 0.005),    ((72.20598,84.47670,84.21267,84.34448),(71.96850,84.21067,84.13277,84.17171),(73.71654,86.83023,83.93129,85.35615)),((64.64525,67.85161,88.55402,76.83269), (64.97362,67.19175,88.62089,76.43273), (66.58796,69.32642,88.79947,77.86390))),
#     ((32, "focal2_0.8", 0.0025),   ((71.30336,86.21352,81.00754,83.52949),(71.97261,85.10751,82.85626,83.96680),(70.23636,86.41608,79.58211,82.85842)),((66.28840,74.07714,84.66491,79.01793), (66.80052,73.14342,86.66247,79.33111), (65.19428,71.71933,84.50784,77.59016))),
#     ((32, "focal2_0.8", 0.001),    ((71.42872,85.37929,81.51072,83.40017),(71.74202,83.00965,84.11000,83.55620),(70.52328,86.69339,79.65675,83.02624)),((68.62092,77.06193,85.83488,81.21217), (67.19776,72.94679,88.50244,79.97522), (66.18669,74.65255,83.65719,78.89878))),
#     ((32, "focal2_0.8", 0.0005),   ((71.28433,83.54839,83.49364,83.52101),(71.43457,83.22599,83.58615,83.40568),(71.70123,85.00261,82.59837,83.78325)),((67.34196,74.79964,87.01159,80.44479), (67.82896,74.30833,88.45138,80.76538), (68.49679,75.61558,87.58543,81.16155))),
#     ((32, "focal2_0.8", 0.00025),  ((71.76560,83.41996,84.01714,83.71749),(71.64266,82.98287,84.51611,83.74247),(72.07960,83.59536,84.06725,83.83064)),((68.44449,74.92914,88.73493,81.24975), (67.29865,73.24292,89.13356,80.41069), (68.46490,75.02007,88.65847,81.27106))),
#     ((32, "focal2_0.8", 0.0001),   ((70.60972,79.83618,86.20154,82.89685),(70.51557,80.01712,85.79438,82.80510),(70.98904,80.60773,85.44187,82.95444)),((65.50844,70.58327,90.09359,79.15390), (65.94996,71.18296,89.83104,79.42712), (66.40810,72.03447,89.29996,79.74337))),
#     ((32, "dice",       0.01),     ((73.87967,83.22537,88.05902,85.57399),(73.43074,81.76303,88.78856,85.13109),(74.33530,83.44831,87.95425,85.64205)),((64.18557,64.82507,91.71559,75.96070), (63.11534,63.76136,91.88821,75.28344), (64.26089,63.14478,93.12661,75.25957))),
#     ((32, "dice",       0.005),    ((72.30103,81.60297,86.82105,84.13118),(73.34913,84.65024,85.95801,85.29911),(73.69669,83.45712,87.48541,85.42381)),((65.14597,66.67197,92.33893,77.43392), (66.32096,70.29616,90.23692,79.02806), (65.61925,66.40645,93.08617,77.51484))),
#     ((32, "dice",       0.0025),   ((73.18260,82.13526,87.88873,84.91464),(73.40537,82.60284,88.14767,85.28523),(73.21403,83.27759,86.38095,84.80089)),((64.94894,67.96629,91.85607,78.12569), (65.54240,66.95749,92.23630,77.58985), (67.30986,71.52607,90.53525,79.91581))),
#     ((32, "dice",       0.001),    ((72.00981,80.58485,86.85714,83.60352),(72.31959,80.61350,87.34280,83.84334),(72.26251,80.04452,87.94304,83.80809)),((66.95481,70.36004,92.15076,79.79446), (67.63533,71.22702,92.68184,80.55027), (66.88072,70.06870,93.02086,79.92971))),
#     ((32, "dice",       0.0005),   ((66.40828,69.41755,94.11396,79.90094),(65.97307,68.83703,93.90267,79.43951),(65.97223,68.67809,94.71174,79.62089)),((57.82053,58.61586,96.43850,72.91412), (57.32773,57.86564,96.62045,72.38197), (56.58813,56.72399,97.42160,71.70029))),
#     ((32, "dice",       0.00025),  ((56.01375,56.16143,97.87096,71.36905),(55.71255,55.91180,97.65301,71.10946),(55.34731,55.36991,98.09767,70.78575)),((45.90251,45.72847,98.65611,62.49134), (46.43411,46.13230,98.53948,62.84367), (45.49568,45.23073,98.71158,62.03592))),
#     ((32, "dice",       0.0001),   ((44.50684,44.25344,99.18742,61.20131),(44.85922,44.76847,98.94880,61.64585),(44.22525,43.82793,99.28553,60.81160)),((35.96011,35.27553,99.12343,52.03361), (36.62052,36.11817,99.02234,52.93018), (35.75680,35.17507,99.09103,51.91979))),
#     ((64, "focal2_0.1", 0.01),     ((72.39654,85.28313,84.12156,84.69836),(72.28150,81.30608,87.95530,84.50009),(72.03577,84.76038,83.98490,84.37086)),((63.97522,66.21289,87.93015,75.54165), (61.94201,62.23881,90.86001,73.87410), (63.41198,64.79098,88.74789,74.90042))),
#     ((64, "focal2_0.1", 0.005),    ((72.47294,87.50122,81.75145,84.52867),(71.14448,84.18964,83.70318,83.94571),(72.56979,84.98608,84.20706,84.59478)),((67.08574,73.28639,87.10957,79.60233), (63.80557,65.90741,88.83265,75.67180), (65.56524,69.04078,89.05632,77.78154))),
#     ((64, "focal2_0.1", 0.0025),   ((71.47848,87.19363,80.57865,83.75573),(71.24407,83.74340,83.19790,83.46976),(72.57067,85.85970,82.72872,84.26513)),((67.25593,74.93758,85.41215,79.83275), (64.85713,68.87143,87.48694,77.07103), (66.70032,69.56688,88.88371,78.04783))),
#     ((64, "focal2_0.1", 0.001),    ((70.95714,87.60070,79.85963,83.55125),(71.52112,85.44203,81.35865,83.35035),(71.05512,81.17654,85.42470,83.24646)),((67.95527,77.92620,83.84406,80.77689), (66.62747,74.56395,84.96349,79.42475), (63.79834,67.19535,90.02154,76.95139))),
#     ((64, "focal2_0.1", 0.0005),   ((72.61735,84.70926,83.96423,84.33510),(72.01739,84.56487,83.06966,83.81059),(72.35194,82.98610,85.27894,84.11690)),((68.23747,75.08165,87.77049,80.93174), (68.34151,75.32938,87.77464,81.07721), (67.11811,72.80447,89.26704,80.19965))),
#     ((64, "focal2_0.1", 0.00025),  ((72.57668,84.08522,84.55781,84.32085),(72.24897,83.12777,84.49824,83.80740),(71.89552,83.39542,84.40854,83.89892)),((68.73319,75.22919,88.81709,81.46040), (68.96009,74.77704,89.72892,81.57349), (68.05725,74.24694,88.75048,80.85345))),
#     ((64, "focal2_0.1", 0.0001),   ((71.55599,81.18797,86.16615,83.60302),(71.02444,80.07877,86.41774,83.12759),(71.93369,81.07495,86.34591,83.62745)),((66.57822,71.47297,90.65681,79.92994), (66.14900,70.49201,91.20965,79.52363), (66.65602,71.54757,90.56635,79.94134))),
#     ((64, "focal2_0.8", 0.01),     ((72.55444,87.92655,81.51107,84.59736),(73.71898,83.72159,86.90515,85.28367),(72.69396,83.03098,86.55370,84.75575)),((66.28780,71.90097,86.08992,78.35830), (65.56218,67.88108,91.77909,78.04155), (63.22003,62.48546,91.17052,74.15047))),
#     ((64, "focal2_0.8", 0.005),    ((71.34090,82.72880,84.45129,83.58117),(72.89546,84.69578,85.19169,84.94301),(71.95756,87.25171,81.16032,84.09585)),((65.51209,70.57481,88.24481,78.42684), (65.64759,71.74989,87.60747,78.88969), (65.96876,68.52713,86.94213,76.64402))),
#     ((64, "focal2_0.8", 0.0025),   ((70.13708,88.25022,78.10377,82.86756),(71.56520,85.56080,81.67471,83.57260),(70.16253,80.84312,84.64156,82.69874)),((67.72773,78.91753,82.34181,80.59332), (67.18204,72.71192,87.04866,79.23701), (63.77463,68.55915,87.47658,76.87111))),
#     ((64, "focal2_0.8", 0.001),    ((72.31370,83.23055,85.02910,84.12021),(71.74083,83.88772,83.35804,83.62204),(71.82551,87.10971,80.73949,83.80372)),((67.56917,73.23273,89.39145,80.50931), (68.21021,75.33643,87.82855,81.10428), (69.56867,78.53242,85.69155,81.95594))),
#     ((64, "focal2_0.8", 0.0005),   ((72.83485,84.91431,84.09458,84.50246),(72.40465,83.65112,84.56447,84.10532),(72.17024,84.41275,83.53989,83.97406)),((69.02835,76.06069,87.99988,81.59586), (68.24856,74.40905,89.11049,81.09889), (68.30378,75.91909,86.99267,81.07953))),
#     ((64, "focal2_0.8", 0.00025),  ((72.28693,82.61165,85.61637,84.08718),(71.57642,82.36668,85.16681,83.74334),(72.01109,83.28613,84.19024,83.73575)),((67.72712,73.45326,89.63094,80.73970), (67.45170,73.41101,89.16726,80.52562), (68.20272,74.73033,88.56050,81.05973))),
#     ((64, "focal2_0.8", 0.0001),   ((71.28592,80.98407,85.88023,83.36032),(70.53994,81.12435,84.74072,82.89311),(71.48658,80.74225,85.93103,83.25587)),((66.26154,71.46959,90.06975,79.69883), (66.82469,72.56408,89.29711,80.06567), (66.56851,71.85650,89.84814,79.85142))),
#     ((64, "dice",       0.01),     ((70.35820,83.13218,83.24170,83.18690),(73.41874,81.78559,87.93498,84.74888),(72.94530,80.55008,88.80783,84.47764)),((64.32319,68.92403,87.82959,77.23674), (65.61825,65.50702,91.51213,76.35612), (65.69347,68.32842,93.09550,78.81197))),
#     ((64, "dice",       0.005),    ((72.82687,82.11317,87.42199,84.68446),(72.60945,81.88163,87.28078,84.49504),(72.28977,83.58015,85.19764,84.38114)),((62.34064,60.90300,91.83067,73.23550), (65.49661,69.43121,90.93932,78.74299), (66.47144,70.53449,89.69989,78.97102))),
#     ((64, "dice",       0.0025),   ((72.69520,80.89252,87.52606,84.07865),(71.65160,84.27627,83.69127,83.98275),(73.17610,88.45846,81.98061,85.09643)),((66.36102,69.83763,91.69356,79.28699), (66.35717,70.81232,88.84664,78.81095), (69.09129,76.71614,86.99630,81.53346))),
#     ((64, "dice",       0.001),    ((72.27679,81.94849,86.02284,83.93625),(72.27111,80.31133,87.78676,83.88283),(72.31540,81.15934,86.79582,83.88301)),((67.97486,72.02510,91.82289,80.72791), (66.96691,70.35585,92.72098,80.00479), (67.87682,71.65395,92.36097,80.70032))),
#     ((64, "dice",       0.0005),   ((65.97080,68.80302,94.16196,79.50944),(66.10264,69.00283,94.03091,79.59578),(66.13286,69.13622,93.85851,79.62249)),((57.92276,58.56258,96.44783,72.87554), (57.33929,57.84675,96.67333,72.38202), (57.99737,58.83324,96.22234,73.01991))),
#     ((64, "dice",       0.00025),  ((55.20407,55.21685,98.18948,70.68436),(54.88345,54.95787,98.18457,70.47054),(55.23850,55.33672,98.20524,70.78659)),((45.24743,44.87543,98.73802,61.70607), (45.67798,45.37122,98.79322,62.18412), (45.92725,45.49539,98.87409,62.31670))),
#     ((64, "dice",       0.0001),   ((44.56158,44.35125,99.23928,61.30469),(44.69272,44.38114,99.22421,61.33036),(44.07950,43.79120,99.37418,60.79283)),((36.00262,35.35907,99.18771,52.13332), (36.49842,35.99291,98.99357,52.79146), (35.85827,35.31318,99.14986,52.07821))),
# )

# pretty = [["BS", "Loss", "LR", "Precision V", "Precision T", "Recall V", "Recall T", "F1 V", "F1 T"]]
# for (bs, loss, lr), vruns, truns in res:
#     vruns, truns = np.array(vruns), np.array(truns)
#     _, precision_mean, recall_mean, f1_mean = vruns.mean(axis=0)
#     _, tprecision_mean, trecall_mean, tf1_mean = truns.mean(axis=0)

#     pretty += [[bs, loss, lr, ffloat(precision_mean), ffloat(tprecision_mean), ffloat(recall_mean), ffloat(trecall_mean), ffloat(f1_mean), ffloat(tf1_mean)]]

# print(tabulate(pretty))
#fmt: on

################################
## CHECKERED ONLY
################################
# fmt: off
# res = (
#     ((32, "focal2_0.1", 0.01),     ((65.01638,84.47688,78.49367,81.37544), (67.77026,85.65029,79.69708,82.56652), (65.20234,78.77205,81.92706,80.31859))),
#     ((32, "focal2_0.1", 0.005),    ((67.92236,82.55525,82.27844,82.41661), (67.45901,84.76142,80.89934,82.78536), (67.30680,85.39003,79.74416,82.47058))),
#     ((32, "focal2_0.1", 0.0025),   ((65.43082,91.07498,74.10261,81.71682), (64.87587,90.39104,72.38362,80.39127), (67.41855,87.46462,77.00434,81.90184))),
#     ((32, "focal2_0.1", 0.001),    ((68.29798,90.72278,75.07866,82.16267), (67.93043,87.81022,77.39935,82.27676), (66.59099,88.38828,76.09719,81.78351))),
#     ((32, "focal2_0.1", 0.0005),   ((70.60089,88.51880,80.28960,84.20362), (68.62364,85.29748,80.50203,82.83041), (68.83428,86.35632,79.45364,82.76130))),
#     ((32, "focal2_0.1", 0.00025),  ((70.50640,86.53680,81.82371,84.11429), (69.38381,88.28783,77.86900,82.75176), (70.71520,88.15274,80.13573,83.95328))),
#     ((32, "focal2_0.1", 0.0001),   ((70.17377,85.57238,82.10275,83.80167), (69.40782,83.95667,82.84799,83.39864), (70.67882,85.20695,83.09258,84.13648))),
#     ((32, "focal2_0.8", 0.01),     ((68.02873,83.59336,80.59849,82.06861), (68.39447,87.86172,79.35259,83.39065), (67.94378,86.55419,78.87835,82.53819))),
#     ((32, "focal2_0.8", 0.005),    ((67.68570,85.78566,78.66362,82.07042), (67.13976,86.75877,78.23990,82.27942), (71.46553,90.54036,79.53862,84.68366))),
#     ((32, "focal2_0.8", 0.0025),   ((67.97940,89.75430,76.00762,82.31095), (68.87499,88.85078,77.92986,83.03276), (67.05232,91.56397,73.88329,81.77890))),
#     ((32, "focal2_0.8", 0.001),    ((68.06178,90.24736,75.24172,82.06422), (68.52552,86.29976,79.40656,82.70979), (66.10473,89.21980,73.16790,80.40049))),
#     ((32, "focal2_0.8", 0.0005),   ((69.91656,87.87034,79.59144,83.52624), (69.00597,88.47208,77.85982,82.82741), (68.55698,88.24181,77.79092,82.68745))),
#     ((32, "focal2_0.8", 0.00025),  ((70.75644,88.51774,79.78550,83.92509), (69.56328,87.60684,79.09423,83.13318), (71.35602,88.80855,80.53304,84.46859))),
#     ((32, "focal2_0.8", 0.0001),   ((70.69954,84.80168,83.59323,84.19312), (69.55480,85.09501,81.71118,83.36877), (70.09591,86.14317,81.51482,83.76511))),
#     ((32, "dice",       0.01),     ((70.74437,84.77493,84.34077,84.55729), (71.71607,86.56314,83.40721,84.95588), (70.16478,81.62697,86.14014,83.82285))),
#     ((32, "dice",       0.005),    ((66.38483,81.74087,81.45741,81.59890), (68.70161,86.97936,79.87507,83.27597), (70.11371,83.30187,84.11685,83.70738))),
#     ((32, "dice",       0.0025),   ((69.71447,83.35197,83.88604,83.61815), (69.30148,84.16877,82.83306,83.49557), (69.77957,86.69098,80.51811,83.49060))),
#     ((32, "dice",       0.001),    ((71.84936,87.19143,82.57584,84.82089), (72.47747,87.38666,82.99956,85.13663), (72.18196,86.64242,83.44280,85.01252))),
#     ((32, "dice",       0.0005),   ((66.95153,72.57376,92.67850,81.40315), (66.17819,72.08915,91.99757,80.83563), (66.57677,71.86497,93.30662,81.19407))),
#     ((32, "dice",       0.00025),  ((56.01326,57.97630,97.25673,72.64672), (54.89506,56.82564,97.09023,71.69130), (55.34516,57.29532,97.58744,72.20046))),
#     ((32, "dice",       0.0001),   ((42.53005,43.15419,98.73344,60.05825), (43.02006,44.09980,98.03528,60.83419), (42.18504,42.67264,98.98606,59.63625))),
#     ((64, "focal2_0.1", 0.01),     ((68.56717,86.55123,80.07028,83.18471), (67.58786,83.60817,81.85701,82.72333), (66.57827,84.84075,79.34226,81.99943))),
#     ((64, "focal2_0.1", 0.005),    ((67.16628,92.71270,73.86377,82.22181), (65.09368,88.37836,75.69184,81.54462), (70.45833,88.87201,79.95889,84.18018))),
#     ((64, "focal2_0.1", 0.0025),   ((66.65076,88.61824,75.15445,81.33291), (66.18510,85.65079,76.56799,80.85511), (70.17827,90.09027,78.04354,83.63533))),
#     ((64, "focal2_0.1", 0.001),    ((65.90616,89.77440,73.61344,80.89467), (69.05772,92.06767,75.11540,82.73206), (67.19042,83.06811,80.26089,81.64038))),
#     ((64, "focal2_0.1", 0.0005),   ((68.94762,88.57604,77.52107,82.68066), (70.06380,90.97376,76.95152,83.37719), (70.21225,87.10165,80.75351,83.80754))),
#     ((64, "focal2_0.1", 0.00025),  ((71.17339,89.39666,79.60866,84.21922), (70.86875,89.36027,79.09193,83.91314), (68.78255,85.94658,79.50991,82.60304))),
#     ((64, "focal2_0.1", 0.0001),   ((70.67985,85.77438,82.41279,84.05999), (69.83390,83.82586,83.22233,83.52301), (71.77897,86.85127,82.76531,84.75908))),
#     ((64, "focal2_0.8", 0.01),     ((68.27654,88.67520,76.92970,82.38593), (72.18123,87.44453,83.03746,85.18403), (69.46900,88.04046,80.85456,84.29464))),
#     ((64, "focal2_0.8", 0.005),    ((67.01696,83.95254,79.94511,81.89983), (71.57267,87.65773,82.40245,84.94889), (69.25274,90.60162,77.29945,83.42359))),
#     ((64, "focal2_0.8", 0.0025),   ((66.63320,92.70315,72.03799,81.07444), (68.55680,91.25262,75.03617,82.35368), (67.88718,83.72850,81.18067,82.43491))),
#     ((64, "focal2_0.8", 0.001),    ((70.29604,87.57503,80.41706,83.84355), (68.91983,89.51513,76.48761,82.49019), (68.13021,91.87457,73.74779,81.81922))),
#     ((64, "focal2_0.8", 0.0005),   ((71.25940,90.14587,79.19413,84.31586), (70.03482,89.18207,78.16411,83.31039), (71.80935,89.30410,80.67887,84.77265))),
#     ((64, "focal2_0.8", 0.00025),  ((71.10608,87.28424,81.64343,84.36966), (69.75530,86.44442,80.54222,83.38901), (71.21750,88.76442,80.24941,84.29242))),
#     ((64, "focal2_0.8", 0.0001),   ((70.77168,85.78623,82.54829,84.13611), (69.46230,85.97644,80.69954,83.25446), (71.06374,86.41225,82.57814,84.45170))),
#     ((64, "dice",       0.01),     ((63.30861,79.81874,79.18724,79.50174), (69.56157,85.77957,82.12227,83.91109), (71.27039,84.19032,85.11357,84.64943))),
#     ((64, "dice",       0.005),    ((72.18659,86.49483,84.00087,85.22961), (69.38210,84.75348,82.07519,83.39284), (66.05931,82.51155,80.39869,81.44142))),
#     ((64, "dice",       0.0025),   ((71.83906,86.85172,82.74579,84.74905), (67.38864,84.89730,79.40197,82.05773), (69.88732,90.32055,77.55437,83.45206))),
#     ((64, "dice",       0.001),    ((72.63145,88.80368,81.90524,85.21507), (72.46197,86.46883,84.04910,85.24180), (72.42906,88.17235,82.40934,85.19349))),
#     ((64, "dice",       0.0005),   ((66.35765,71.97598,92.48789,80.95281), (66.43927,72.22926,92.36961,81.06724), (66.39248,72.42436,92.02283,81.05574))),
#     ((64, "dice",       0.00025),  ((55.14242,56.96547,97.45998,71.90335), (54.46350,56.17375,97.60581,71.30837), (54.18400,56.12073,97.80562,71.31882))),
#     ((64, "dice",       0.0001),   ((42.33127,43.02683,98.78741,59.94474), (41.99288,42.69713,98.79085,59.62465), (41.69367,42.26565,99.15486,59.26785))),
# )

# pretty = [["BS", "Loss", "LR", "Precision V", "Recall V", "F1 V"]]
# for (bs, loss, lr), vruns in res:
#     vruns = np.array(vruns)
#     _, precision_mean, recall_mean, f1_mean = vruns.mean(axis=0)

#     pretty += [[bs, loss, lr, ffloat(precision_mean), ffloat(recall_mean), ffloat(f1_mean)]]

# print(tabulate(pretty))
#fmt: on


###########################################
## F1 for both, checkered and uncheckered
###########################################
# fmt: off
res = (
    ((32, "focal2_0.1", 0.01),         (((83.872,81.375,84.885), (85.468,78.494,88.531), (82.334,84.477,81.529)), ((84.842,82.567,85.791), (84.974,79.697,87.292), (84.711,85.650,84.340)), ((84.358,80.319,86.145), (85.597,81.927,87.209), (83.153,78.772,85.106)))),
    ((32, "focal2_0.1", 0.005),        (((83.628,82.417,84.152), (84.316,82.278,85.211), (82.951,82.555,83.119)), ((84.401,82.785,85.046), (88.224,80.899,91.441), (80.895,84.761,79.486)), ((84.663,82.471,85.573), (85.199,79.744,87.594), (84.134,85.390,83.643)))),
    ((32, "focal2_0.1", 0.0025),       (((82.975,81.717,83.489), (79.242,74.103,81.499), (87.078,91.075,85.578)), ((83.146,80.391,84.250), (79.838,72.384,83.111), (86.740,90.391,85.421)), ((83.778,81.902,84.563), (81.435,77.004,83.380), (86.259,87.465,85.780)))),
    ((32, "focal2_0.1", 0.001),        (((84.132,82.163,84.923), (81.943,75.079,84.958), (86.442,90.723,84.888)), ((83.675,82.277,84.260), (81.416,77.399,83.180), (86.063,87.810,85.368)), ((83.257,81.784,83.863), (81.121,76.097,83.327), (85.509,88.388,84.406)))),
    ((32, "focal2_0.1", 0.0005),       (((84.184,84.204,84.176), (84.348,80.290,86.130), (84.021,88.519,82.309)), ((83.916,82.830,84.356), (86.178,80.502,88.671), (81.769,85.297,80.442)), ((84.367,82.761,85.026), (84.873,79.454,87.253), (83.866,86.356,82.910)))),
    ((32, "focal2_0.1", 0.00025),      (((83.809,84.114,83.683), (85.523,81.824,87.148), (82.162,86.537,80.484)), ((84.384,82.752,85.039), (84.643,77.869,87.618), (84.127,88.288,82.607)), ((84.018,83.953,84.044), (84.985,80.136,87.115), (83.073,88.153,81.183)))),
    ((32, "focal2_0.1", 0.0001),       (((83.022,83.802,82.704), (85.795,82.103,87.417), (80.422,85.572,78.474)), ((82.931,83.399,82.739), (86.270,82.848,87.772), (79.841,83.957,78.251)), ((83.427,84.136,83.137), (86.754,83.093,88.362), (80.345,85.207,78.495)))),
    ((32, "focal2_0.8", 0.01),         (((84.208,82.069,85.101), (85.690,80.598,87.925), (82.777,83.593,82.453)), ((84.613,83.391,85.104), (85.775,79.353,88.596), (83.482,87.862,81.877)), ((84.722,82.538,85.623), (84.583,78.878,87.089), (84.861,86.554,84.206)))),
    ((32, "focal2_0.8", 0.005),        (((84.344,82.070,85.287), (84.213,78.664,86.650), (84.477,85.786,83.966)), ((84.172,82.279,84.946), (84.133,78.240,86.721), (84.211,86.759,83.242)), ((85.356,84.684,85.633), (83.931,79.539,85.860), (86.830,90.540,85.406)))),
    ((32, "focal2_0.8", 0.0025),       (((83.529,82.311,84.029), (81.008,76.008,83.203), (86.214,89.754,84.870)), ((83.967,83.033,84.349), (82.856,77.930,85.020), (85.108,88.851,83.688)), ((82.858,81.779,83.293), (79.582,73.883,82.085), (86.416,91.564,84.537)))),
    ((32, "focal2_0.8", 0.001),        (((83.400,82.064,83.936), (81.511,75.242,84.264), (85.379,90.247,83.611)), ((83.556,82.710,83.904), (84.110,79.407,86.176), (83.010,86.300,81.748)), ((83.026,80.400,84.096), (79.657,73.168,82.506), (86.693,89.220,85.748)))),
    ((32, "focal2_0.8", 0.0005),       (((83.521,83.526,83.519), (83.494,79.591,85.207), (83.548,87.870,81.896)), ((83.406,82.827,83.638), (83.586,77.860,86.101), (83.226,88.472,81.311)), ((83.783,82.687,84.233), (82.598,77.791,84.710), (85.003,88.242,83.763)))),
    ((32, "focal2_0.8", 0.00025),      (((83.717,83.925,83.633), (84.017,79.785,85.876), (83.420,88.518,81.505)), ((83.742,83.133,83.989), (84.516,79.094,86.897), (82.983,87.607,81.268)), ((83.831,84.469,83.570), (84.067,80.533,85.619), (83.595,88.809,81.616)))),
    ((32, "focal2_0.8", 0.0001),       (((82.897,84.193,82.364), (86.202,83.593,87.347), (79.836,84.802,77.919)), ((82.805,83.369,82.576), (85.794,81.711,87.588), (80.017,85.095,78.108)), ((82.954,83.765,82.626), (85.442,81.515,87.166), (80.608,86.143,78.535)))),
    ((32, "dice",       0.01),         (((85.574,84.557,86.001), (88.059,84.341,89.692), (83.225,84.775,82.602)), ((85.131,84.956,85.202), (88.789,83.407,91.152), (81.763,86.563,79.981)), ((85.642,83.823,86.442), (87.954,86.140,88.751), (83.448,81.627,84.250)))),
    ((32, "dice",       0.005),        (((84.131,81.599,85.192), (86.821,81.457,89.177), (81.603,81.741,81.548)), ((85.299,83.276,86.127), (85.958,79.875,88.629), (84.650,86.979,83.763)), ((85.424,83.707,86.157), (87.485,84.117,88.965), (83.457,83.302,83.522)))),
    ((32, "dice",       0.0025),       (((84.915,83.618,85.459), (87.889,83.886,89.647), (82.135,83.352,81.645)), ((85.285,83.496,86.027), (88.148,82.833,90.482), (82.603,84.169,81.990)), ((84.801,83.491,85.333), (86.381,80.518,88.956), (83.278,86.691,81.994)))),
    ((32, "dice",       0.001),        (((83.604,84.821,83.116), (86.857,82.576,88.737), (80.585,87.191,78.164)), ((83.843,85.137,83.326), (87.343,83.000,89.250), (80.613,87.387,78.140)), ((83.808,85.013,83.327), (87.943,83.443,89.919), (80.045,86.642,77.635)))),
    ((32, "dice",       0.0005),       (((79.901,81.403,79.273), (94.114,92.679,94.744), (69.418,72.574,68.144)), ((79.440,80.836,78.859), (93.903,91.998,94.739), (68.837,72.089,67.538)), ((79.621,81.194,78.963), (94.712,93.307,95.329), (68.678,71.865,67.393)))),
    ((32, "dice",       0.00025),      (((71.369,72.647,70.827), (97.871,97.257,98.141), (56.161,57.976,55.407)), ((71.109,71.691,70.859), (97.653,97.090,97.900), (55.912,56.826,55.523)), ((70.786,72.200,70.186), (98.098,97.587,98.322), (55.370,57.295,54.571)))),
    ((32, "dice",       0.0001),       (((61.201,60.058,61.714), (99.187,98.733,99.387), (44.253,43.154,44.751)), ((61.646,60.834,62.004), (98.949,98.035,99.350), (44.768,44.100,45.065)), ((60.812,59.636,61.340), (99.286,98.986,99.417), (43.828,42.673,44.353)))),
    ((64, "focal2_0.1", 0.01),         (((84.698,83.185,85.334), (84.122,80.070,85.901), (85.283,86.551,84.775)), ((84.500,82.723,85.226), (87.955,81.857,90.633), (81.306,83.608,80.428)), ((84.371,81.999,85.371), (83.985,79.342,86.024), (84.760,84.841,84.728)))),
    ((64, "focal2_0.1", 0.005),        (((84.529,82.222,85.441), (81.751,73.864,85.215), (87.501,92.713,85.668)), ((83.946,81.545,84.898), (83.703,75.692,87.221), (84.190,88.378,82.696)), ((84.595,84.180,84.765), (84.207,79.959,86.073), (84.986,88.872,83.497)))),
    ((64, "focal2_0.1", 0.0025),       (((83.756,81.333,84.760), (80.579,75.154,82.961), (87.194,88.618,86.640)), ((83.470,80.855,84.537), (83.198,76.568,86.110), (83.743,85.651,83.021)), ((84.265,83.635,84.522), (82.729,78.044,84.786), (85.860,90.090,84.260)))),
    ((64, "focal2_0.1", 0.001),        (((83.551,80.895,84.639), (79.860,73.613,82.603), (87.601,89.774,86.778)), ((83.350,82.732,83.595), (81.359,75.115,84.100), (85.442,92.068,83.096)), ((83.246,81.640,83.910), (85.425,80.261,87.692), (81.177,83.068,80.440)))),
    ((64, "focal2_0.1", 0.0005),       (((84.335,82.681,85.002), (83.964,77.521,86.794), (84.709,88.576,83.283)), ((83.811,83.377,83.983), (83.070,76.952,85.757), (84.565,90.974,82.281)), ((84.117,83.808,84.243), (85.279,80.754,87.266), (82.986,87.102,81.423)))),
    ((64, "focal2_0.1", 0.00025),      (((84.321,84.219,84.362), (84.558,79.609,86.731), (84.085,89.397,82.119)), ((83.807,83.913,83.765), (84.498,79.092,86.872), (83.128,89.360,80.873)), ((83.899,82.603,84.433), (84.409,79.510,86.560), (83.395,85.947,82.409)))),
    ((64, "focal2_0.1", 0.0001),       (((83.603,84.060,83.416), (86.166,82.413,87.814), (81.188,85.774,79.437)), ((83.128,83.523,82.964), (86.418,83.222,87.821), (80.079,83.826,78.616)), ((83.627,84.759,83.168), (86.346,82.765,87.918), (81.075,86.851,78.905)))),
    ((64, "focal2_0.8", 0.01),         (((84.597,82.386,85.526), (81.511,76.930,83.523), (87.927,88.675,87.627)), ((85.284,85.184,85.325), (86.905,83.037,88.604), (83.722,87.445,82.280)), ((84.756,84.295,84.941), (86.554,80.855,89.057), (83.031,88.040,81.189)))),
    ((64, "focal2_0.8", 0.005),        (((83.581,81.900,84.284), (84.451,79.945,86.430), (82.729,83.953,82.242)), ((84.943,84.949,84.941), (85.192,82.402,86.417), (84.696,87.658,83.514)), ((84.096,83.424,84.374), (81.160,77.299,82.856), (87.252,90.602,85.950)))),
    ((64, "focal2_0.8", 0.0025),       (((82.868,81.074,83.592), (78.104,72.038,80.768), (88.250,92.703,86.620)), ((83.573,82.354,84.057), (81.675,75.036,84.590), (85.561,91.253,83.531)), ((82.699,82.435,82.808), (84.642,81.181,86.161), (80.843,83.729,79.707)))),
    ((64, "focal2_0.8", 0.001),        (((84.120,83.844,84.233), (85.029,80.417,87.055), (83.231,87.575,81.589)), ((83.622,82.490,84.071), (83.358,76.488,86.375), (83.888,89.515,81.886)), ((83.804,81.819,84.597), (80.739,73.748,83.810), (87.110,91.875,85.398)))),
    ((64, "focal2_0.8", 0.0005),       (((84.502,84.316,84.578), (84.095,79.194,86.247), (84.914,90.146,82.973)), ((84.105,83.310,84.422), (84.564,78.164,87.375), (83.651,89.182,81.661)), ((83.974,84.773,83.645), (83.540,80.679,84.796), (84.413,89.304,82.524)))),
    ((64, "focal2_0.8", 0.00025),      (((84.087,84.370,83.972), (85.616,81.643,87.361), (82.612,87.284,80.836)), ((83.743,83.389,83.888), (85.167,80.542,87.198), (82.367,86.444,80.820)), ((83.736,84.292,83.510), (84.190,80.249,85.921), (83.286,88.764,81.230)))),
    ((64, "focal2_0.8", 0.0001),       (((83.360,84.136,83.043), (85.880,82.548,87.343), (80.984,85.786,79.145)), ((82.893,83.254,82.746), (84.741,80.700,86.515), (81.124,85.976,79.291)), ((83.256,84.452,82.770), (85.931,82.578,87.403), (80.742,86.412,78.602)))),
    ((64, "dice",       0.01),         (((83.187,79.502,84.795), (83.242,79.187,85.022), (83.132,79.819,84.568)), ((84.749,83.911,85.087), (87.935,82.122,90.488), (81.786,85.780,80.296)), ((84.478,84.649,84.407), (88.808,85.114,90.430), (80.550,84.190,79.136)))),
    ((64, "dice",       0.005),        (((84.684,85.230,84.460), (87.422,84.001,88.924), (82.113,86.495,80.423)), ((84.495,83.393,84.947), (87.281,82.075,89.567), (81.882,84.753,80.780)), ((84.381,81.441,85.631), (85.198,80.399,87.305), (83.580,82.512,84.020)))),
    ((64, "dice",       0.0025),       (((84.079,84.749,83.810), (87.526,82.746,89.625), (80.893,86.852,78.703)), ((83.983,82.058,84.793), (83.691,79.402,85.575), (84.276,84.897,84.026)), ((85.096,83.452,85.782), (81.981,77.554,83.924), (88.458,90.321,87.724)))),
    ((64, "dice",       0.001),        (((83.936,85.215,83.424), (86.023,81.905,87.831), (81.948,88.804,79.437)), ((83.883,85.242,83.334), (87.787,84.049,89.428), (80.311,86.469,78.018)), ((83.883,85.193,83.360), (86.796,82.409,88.722), (81.159,88.172,78.609)))),
    ((64, "dice",       0.0005),       (((79.509,80.953,78.907), (94.162,92.488,94.897), (68.803,71.976,67.529)), ((79.596,81.067,78.982), (94.031,92.370,94.760), (69.003,72.229,67.708)), ((79.622,81.056,79.026), (93.859,92.023,94.665), (69.136,72.424,67.822)))),
    ((64, "dice",       0.00025),      (((70.684,71.903,70.168), (98.189,97.460,98.510), (55.217,56.965,54.490)), ((70.471,71.308,70.112), (98.185,97.606,98.439), (54.958,56.174,54.445)), ((70.787,71.319,70.557), (98.205,97.806,98.381), (55.337,56.121,55.001)))),
    ((64, "dice",       0.0001),       (((61.305,59.945,61.918), (99.239,98.787,99.438), (44.351,43.027,44.955)), ((61.330,59.625,62.106), (99.224,98.791,99.415), (44.381,42.697,45.158)), ((60.793,59.268,61.485), (99.374,99.155,99.471), (43.791,42.266,44.494)))),
)

pretty =  [["",   "",     "",   "Valid","",      "",    "",    "",    "",    "",    "",    "",    "Test"]]
pretty += [["BS", "Loss", "LR", "F B", "F C", "F U", "R B", "R C", "R U", "P B", "P C", "P U"]]
for ((bs, loss, lr), vvalues) in res:
    def make_row(values):
        values = np.array(values)
        f1ms, rms, pms = values.mean(axis=0)
        return [*ffloats(f1ms), *ffloats(rms), *ffloats(pms)]

    pretty += [[bs, loss, lr, *make_row(vvalues)]]
print(tabulate(pretty))


# print(data)

#fmt: on

#################################################
##  BEST FOLDS
#################################################
data = []
for (bs, loss, lr), values in res:
    values = np.array(values)
    f1ms, rms, pms = values.mean(axis=0)
    data.append((bs, loss, lr, *f1ms, *rms, *pms))

# fmt: off
data = pd.DataFrame(data, columns=["BS", "Loss", "LR", "F1 B", "F1 C", "F1 U", "R B", "R C", "R U", "P B", "P C", "P U"])
# fmt: on

metrics = ["F1 B", "R B", "P B", "F1 C", "R C", "P C"]

best = []
for bs in (32, 64):
    for loss in ("focal2_0.1", "focal2_0.8", "dice"):
        d = data
        d = d.loc[d["Loss"] == loss]
        d = d.loc[d["BS"] == bs]

        for metric in metrics:
            max_idx = d[metric].argmax()
            best_row = d.iloc[max_idx]
            best_lr = best_row["LR"]
            best_val = best_row[metric]
            print(fsci(best_lr))
            best.append((bs, loss, fsci(best_lr), metric, best_val))

print(tabulate(best))


#####################################################
## VALID AND TEST FOR BEST FOLDS
#####################################################
# fmt: off
res = (
    ((32, "focal2_0.1", 0.01   , "F B"),  ((83.872,81.375,84.885), (85.468,78.494,88.531), (82.334,84.477,81.529)), ((74.872,69.550,81.328), (90.822,89.238,92.526), (63.687,56.979,72.548))),
    ((32, "focal2_0.1", 0.0001 , "R B" ), ((83.427,84.136,83.137), (86.754,83.093,88.362), (80.345,85.207,78.495)), ((79.264,77.716,80.924), (90.923,89.007,92.984), (70.255,68.967,71.634))),
    ((32, "focal2_0.1", 0.0025 , "P B" ), ((82.975,81.717,83.489), (79.242,74.103,81.499), (87.078,91.075,85.578)), ((76.815,72.304,82.249), (85.250,84.603,85.945), (69.899,63.126,78.858))),
    ((32, "focal2_0.1", 0.0001 , "F C"),  ((83.427,84.136,83.137), (86.754,83.093,88.362), (80.345,85.207,78.495)), ((79.264,77.716,80.924), (90.923,89.007,92.984), (70.255,68.967,71.634))),
    ((32, "focal2_0.1", 0.0001 , "R C" ), ((83.427,84.136,83.137), (86.754,83.093,88.362), (80.345,85.207,78.495)), ((79.264,77.716,80.924), (90.923,89.007,92.984), (70.255,68.967,71.634))),
    ((32, "focal2_0.1", 0.0025 , "P C" ), ((82.975,81.717,83.489), (79.242,74.103,81.499), (87.078,91.075,85.578)), ((76.815,72.304,82.249), (85.250,84.603,85.945), (69.899,63.126,78.858))),
    ((32, "focal2_0.8", 0.005  , "F B"),  ((85.356,84.684,85.633), (83.931,79.539,85.860), (86.830,90.540,85.406)), ((77.864,73.536,83.038), (88.799,88.118,89.533), (69.326,63.095,77.422))),
    ((32, "focal2_0.8", 0.0001 , "R B" ), ((82.897,84.193,82.364), (86.202,83.593,87.347), (79.836,84.802,77.919)), ((79.154,77.904,80.497), (90.094,88.630,91.668), (70.583,69.494,71.753))),
    ((32, "focal2_0.8", 0.0025 , "P B" ), ((82.858,81.779,83.293), (79.582,73.883,82.085), (86.416,91.564,84.537)), ((77.590,73.677,82.040), (84.508,82.389,86.787), (71.719,66.631,77.785))),
    ((32, "focal2_0.8", 0.00025, "F C"),  ((83.831,84.469,83.570), (84.067,80.533,85.619), (83.595,88.809,81.616)), ((81.271,80.063,82.539), (88.658,86.310,91.184), (75.020,74.660,75.391))),
    ((32, "focal2_0.8", 0.0001 , "R C" ), ((82.897,84.193,82.364), (86.202,83.593,87.347), (79.836,84.802,77.919)), ((79.154,77.904,80.497), (90.094,88.630,91.668), (70.583,69.494,71.753))),
    ((32, "focal2_0.8", 0.0025 , "P C" ), ((82.858,81.779,83.293), (79.582,73.883,82.085), (86.416,91.564,84.537)), ((77.590,73.677,82.040), (84.508,82.389,86.787), (71.719,66.631,77.785))),
    ((32, "dice"      , 0.01   , "F B"),  ((85.642,83.823,86.442), (87.954,86.140,88.751), (83.448,81.627,84.250)), ((75.260,69.917,81.997), (93.127,93.115,93.139), (63.145,55.972,73.236))),
    ((32, "dice"      , 0.0001 , "R B" ), ((60.812,59.636,61.340), (99.286,98.986,99.417), (43.828,42.673,44.353)), ((51.920,49.812,54.363), (99.091,98.489,99.739), (35.175,33.336,37.365))),
    ((32, "dice"      , 0.005  , "P B" ), ((85.299,83.276,86.127), (85.958,79.875,88.629), (84.650,86.979,83.763)), ((79.028,76.362,81.993), (90.237,88.598,92.000), (70.296,67.096,73.950))),
    ((32, "dice"      , 0.001  , "F C"),  ((83.843,85.137,83.326), (87.343,83.000,89.250), (80.613,87.387,78.140)), ((80.550,79.434,81.787), (92.682,92.707,92.654), (71.227,69.486,73.201))),
    ((32, "dice"      , 0.0001 , "R C" ), ((60.812,59.636,61.340), (99.286,98.986,99.417), (43.828,42.673,44.353)), ((51.920,49.812,54.363), (99.091,98.489,99.739), (35.175,33.336,37.365))),
    ((32, "dice"      , 0.001  , "P C" ), ((83.843,85.137,83.326), (87.343,83.000,89.250), (80.613,87.387,78.140)), ((80.550,79.434,81.787), (92.682,92.707,92.654), (71.227,69.486,73.201))),
    ((64, "focal2_0.1", 0.01   , "F B"),  ((84.698,83.185,85.334), (84.122,80.070,85.901), (85.283,86.551,84.775)), ((75.542,70.765,81.119), (87.930,85.622,90.413), (66.213,60.302,73.557))),
    ((64, "focal2_0.1", 0.0001 , "R B" ), ((83.128,83.523,82.964), (86.418,83.222,87.821), (80.079,83.826,78.616)), ((79.524,77.950,81.219), (91.210,89.478,93.072), (70.492,69.053,72.044))),
    ((64, "focal2_0.1", 0.0025 , "P B" ), ((83.756,81.333,84.760), (80.579,75.154,82.961), (87.194,88.618,86.640)), ((79.833,76.911,83.067), (85.412,83.431,87.543), (74.938,71.337,79.027))),
    ((64, "focal2_0.1", 0.0001 , "F C"),  ((83.627,84.759,83.168), (86.346,82.765,87.918), (81.075,86.851,78.905)), ((79.941,78.476,81.499), (90.566,88.421,92.873), (71.548,70.542,72.607))),
    ((64, "focal2_0.1", 0.0001 , "R C" ), ((83.128,83.523,82.964), (86.418,83.222,87.821), (80.079,83.826,78.616)), ((79.524,77.950,81.219), (91.210,89.478,93.072), (70.492,69.053,72.044))),
    ((64, "focal2_0.1", 0.005  , "P C" ), ((84.529,82.222,85.441), (81.751,73.864,85.215), (87.501,92.713,85.668)), ((79.602,76.872,82.644), (87.110,85.547,88.790), (73.286,69.795,77.293))),
    ((64, "focal2_0.8", 0.01   , "F B"),  ((85.284,85.184,85.325), (86.905,83.037,88.604), (83.722,87.445,82.280)), ((78.042,74.622,82.089), (91.779,91.793,91.764), (67.881,62.863,74.260))),
    ((64, "focal2_0.8", 0.0001 , "R B" ), ((83.256,84.452,82.770), (85.931,82.578,87.403), (80.742,86.412,78.602)), ((79.851,78.326,81.476), (89.848,87.699,92.160), (71.856,70.763,73.011))),
    ((64, "focal2_0.8", 0.01   , "P B" ), ((84.597,82.386,85.526), (81.511,76.930,83.523), (87.927,88.675,87.627)), ((78.358,74.724,82.551), (86.090,84.855,87.418), (71.901,66.753,78.197))),
    ((64, "focal2_0.8", 0.0005 , "F C"),  ((83.974,84.773,83.645), (83.540,80.679,84.796), (84.413,89.304,82.524)), ((81.080,79.644,82.591), (86.993,84.574,89.594), (75.919,75.257,76.603))),
    ((64, "focal2_0.8", 0.0001 , "R C" ), ((83.256,84.452,82.770), (85.931,82.578,87.403), (80.742,86.412,78.602)), ((79.851,78.326,81.476), (89.848,87.699,92.160), (71.856,70.763,73.011))),
    ((64, "focal2_0.8", 0.001  , "P C" ), ((83.804,81.819,84.597), (80.739,73.748,83.810), (87.110,91.875,85.398)), ((81.956,80.473,83.514), (85.692,83.193,88.379), (78.532,77.926,79.157))),
    ((64, "dice"      , 0.005  , "F B"),  ((84.684,85.230,84.460), (87.422,84.001,88.924), (82.113,86.495,80.423)), ((73.236,67.619,80.554), (91.831,92.573,91.032), (60.903,53.262,72.239))),
    ((64, "dice"      , 0.0001 , "R B" ), ((60.793,59.268,61.485), (99.374,99.155,99.471), (43.791,42.266,44.494)), ((52.078,50.137,54.311), (99.150,98.537,99.810), (35.313,33.623,37.305))),
    ((64, "dice"      , 0.0025 , "P B" ), ((85.096,83.452,85.782), (81.981,77.554,83.924), (88.458,90.321,87.724)), ((81.533,80.229,82.968), (86.996,86.525,87.503), (76.716,74.787,78.881))),
    ((64, "dice"      , 0.001  , "F C"),  ((83.883,85.242,83.334), (87.787,84.049,89.428), (80.311,86.469,78.018)), ((80.005,78.705,81.446), (92.721,92.543,92.912), (70.356,68.466,72.500))),
    ((64, "dice"      , 0.0001 , "R C" ), ((60.793,59.268,61.485), (99.374,99.155,99.471), (43.791,42.266,44.494)), ((52.078,50.137,54.311), (99.150,98.537,99.810), (35.313,33.623,37.305))),
    ((64, "dice"      , 0.001  , "P C" ), ((83.936,85.215,83.424), (86.023,81.905,87.831), (81.948,88.804,79.437)), ((80.728,79.378,82.230), (91.823,91.758,91.892), (72.025,69.941,74.406))),
)

pretty = [["BS", "Loss", "LR", "Metric", "F V", "F T", "R V", "R T", "P V", "R T"]]
for (bs, loss, lr, metric), vvalues, tvalues in res:
    vvalues, tvalues = np.array(vvalues), np.array(tvalues)

    vf, vr, vp = vvalues
    tf, tr, tp = tvalues

    pretty += [[bs, loss, lr, metric, ffloat(vf[0]), ffloat(tf[0]), ffloat(vr[0]), ffloat(tr[0]), ffloat(vp[0]), ffloat(tp[0])]]

print(tabulate(pretty))
# fmt: on
